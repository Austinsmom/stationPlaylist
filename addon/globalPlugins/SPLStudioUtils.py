# Station Playlist Utilities# Author: Joseph Lee# Copyright 2013, released under GPL.# Adds a few utility features such as switching focus to the SPL Studio window.
import globalPluginHandlerimport apiclass GlobalPlugin(globalPluginHandler.GlobalPlugin):
	# Switch focus to SPL Studio window from anywhere.	def script_focusToSPLWindow(self, gesture):		import appModuleHandler, NVDAObjects, ui		fgTest = api.getForegroundObject()		# Deal with UIA controls such as File Explorer.		fg = fgTest.simpleParent if not isinstance(fgTest.simpleParent, NVDAObjects.window.Desktop) else fgTest		# Don't do anything if we're already focus on SPL Studio.		if "splstudio" in appModuleHandler.getAppModuleForNVDAObject(fg).appModuleName: return		else: # If not, search the open windows.			while fg.simpleNext != None:				if "splstudio" in appModuleHandler.getAppModuleForNVDAObject(fg).appModuleName: break				else: fg = fg.simpleNext			# One last check: in case user pressed Windows+M to minimize windows, give a message to switch to SPL Studio window manually.			fg.setFocus() if fg.name != "Program Manager" else ui.message("Press Alt+Tab to switch to SPL Studio window")	script_focusToSPLWindow.__doc__="Moves to SPL Studio window from other programs."	__gestures={		"kb:nvda+`":"focusToSPLWindow"	}