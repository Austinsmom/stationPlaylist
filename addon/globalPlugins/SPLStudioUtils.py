# Station Playlist Utilities# Author: Joseph Lee# Copyright 2013, released under GPL.# Adds a few utility features such as switching focus to the SPL Studio window.
import globalPluginHandlerimport apiclass GlobalPlugin(globalPluginHandler.GlobalPlugin):
	# Try to see if SPL foreground object can be fetched.	def fetchSPLForegroundWindow(self):		# Let us see if SPL foreground can be fetched.		import appModuleHandler, NVDAObjects		# First test: is splstudio running?		appTable = appModuleHandler.runningTable.values()		SPLRunning = False		for i in range(0, len(appTable)):			if appTable[i].appName == "splstudio": SPLRunning = True		if not SPLRunning: return None		# Continue with the method.		fgTest = api.getForegroundObject()		# In some windows, the parent of foreground window is Desktop.		fg = fgTest.simpleParent if not isinstance(fgTest.simpleParent, NVDAObjects.window.Desktop) else fgTest		while fg.simpleNext != None:			if "splstudio" in appModuleHandler.getAppModuleForNVDAObject(fg).appModuleName: break			else: fg = fg.simpleNext		return fg	# Switch focus to SPL Studio window from anywhere.	def script_focusToSPLWindow(self, gesture):		import appModuleHandler, ui		# Don't do anything if we're already focus on SPL Studio.		if "splstudio" in appModuleHandler.getAppModuleForNVDAObject(api.getForegroundObject()).appModuleName: return		else: SPLFG = self.fetchSPLForegroundWindow()		# SPL, are you running?		if SPLFG == None: ui.message("SPL Studio is not running")		# If user pressed Windows+M to minimize windows, give a message to switch to SPL Studio window manually. If not, move focus.		else: SPLFG.setFocus() if SPLFG.name != "Program Manager" else ui.message("Press Alt+Tab to switch to SPL Studio window")	script_focusToSPLWindow.__doc__="Moves to SPL Studio window from other programs."	__gestures={		"kb:nvda+`":"focusToSPLWindow"	}